/** https://github.com/martinkr/jPoshLoad - Copyright (c) 2011-2012 Martin Krause - Dual licensed under the MIT and GPL licenses. */
(function(d){d.fn.jPoshLoad=function(g,e){jQuery("html").addClass("jPoshLoad_completed-false");var h=d.extend({},d.fn.jPoshLoad.oDefaults,e);var f=a(g,h.sTextHeadline);var j={};j[g]={oOptions:h,_aLoad:[],_aLoaded:[],$elWrapper:f};var l=e.images;var k=e.forceNoCache||false;var i;for(i in l){if(!l[i]["id"]){l[i]["id"]=["jPoshload_",++d.fn.jPoshLoad.UID].join("")}f.append('<li class=""></li>');j[g]._aLoad.push(l[i]["id"])}d(document).data("jPoshload",j);f.find(".jPoshLoad_counter").text(["0 / ",f.find("li").size()].join("")).end().find(".jPoshload_percentage").text("0%").end();for(i in l){c(g,k,l[i])}};function c(e,g,h){var i=h.src;var f=document.createElement("img");jQuery(f).bind("load.jPoshLoad",{sIdElement:h.id,sIdLoader:e},d.fn.jPoshLoad.onLoadItem);f.src=[i,(g?["?",h.id,"-",d.fn.jPoshLoad.UID].join(""):"")].join("");if(f.complete||f.readyState===4){d.fn.jPoshLoad.onLoadItem({target:f,data:{sIdLoader:e,sIdElement:h.id}})}}function b(f,e){if(jQuery("html").hasClass("jPoshLoad_completed-false")===false){return}jQuery("html").removeClass("jPoshLoad_completed-false");e.fadeOut(1000)}function a(f,e){return jQuery(["#",f].join("")).append('<div class="jPoshLoad_wrapper"><h1>'+e+'</h1><span class="jPoshLoad_counter"></span><span class="jPoshload_percentage"></span><ol id="jPoshLoad_'+f+'"></ol></div>')}d.fn.jPoshLoad.onComplete=function(e){b(e,d(document).data("jPoshload")[e].$elWrapper)};d.fn.jPoshLoad.updateStatus=function(f){var e=d(document).data("jPoshload")[f].$elWrapper;var g=e.find("li");var h=g.not(".loaded");h.eq(0).addClass("loaded");h=e.find("li").not(".loaded");e.find(".jPoshLoad_counter").text([g.size()-h.size()," / ",g.size()].join("")).end().find(".jPoshload_percentage").stop().animate({width:[Math.floor(((g.size()-h.size())*100)/g.size()),"% "].join("")}).end();if(h.size()===0){b(f,e)}};d.fn.jPoshLoad.onLoadItem=function(f){var h;var j;var e=jQuery(f.target);var g=d(document).data("jPoshload");var i=g[f.data.sIdLoader]._aLoad;g[f.data.sIdLoader]._aLoaded.push(f.data.sIdElement);e.unbind("load.jPoshLoad");for(h=0;h<i.length;h++){if(i[h]==f.data.sIdElement){j=h;break}}g[f.data.sIdLoader]._aLoad=i.slice(0,j).concat(i.slice(j+1));d(document).data("jPoshload",g);e=null;d.fn.jPoshLoad.updateStatus(f.data.sIdLoader);jQuery("document").triggerHandler("jPoshLoad;load;element",{element:f.target,id:f.data.sIdElement});return};d.fn.jPoshLoad.__version=1.1;d.fn.jPoshLoad.__class="$.fn.jPoshLoad";d.fn.jPoshLoad.UIDBase=new Date().getTime();d.fn.jPoshLoad.UID=d.fn.jPoshLoad.UIDBase;d.fn.jPoshLoad.sClassLoaded="jPoshLoad_loaded";d.fn.jPoshLoad.oDefaults={forceNoCache:false,sTextHeadline:"Loading...",images:{}}})(jQuery);